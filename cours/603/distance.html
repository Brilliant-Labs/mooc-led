<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="nico" />
  <meta name="author" content="Pierre-Yves Rochat, EPFL" />
  <title>Commande à distance</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../../statiques/style.css" type="text/css" />
</head>
<body>
<h1 class="title">Commande à distance</h1>
<div id="header">
<p class="author"><a href="&#x6d;&#x61;&#x69;&#108;&#116;&#x6f;&#58;&#112;&#x79;&#114;&#64;&#112;&#x79;&#114;&#46;&#x63;&#104;" class="email">&#80;&#x69;&#x65;&#114;&#114;&#x65;&#x2d;&#x59;&#118;&#x65;&#x73;&#32;&#82;&#x6f;&#x63;&#104;&#x61;&#116;</a>, EPFL</p>
<p class="date">rév 2016/07/10</p>
</div>
<h2 id="changer-le-comportement-de-lenseigne-ou-de-lafficheur">Changer le comportement de l’enseigne ou de l’afficheur</h2>
<p>Les enseignes et afficheurs fonctionnent généralement sans intervention humaine. Mais il est souvent utile de pouvoir modifier leur comportement. Pour une enseigne, on souhaitera par exemple :</p>
<ul>
<li>l’allumer et l’éteindre</li>
<li>changer sa luminosité</li>
<li>activer des informations exceptionnelles (exemple : Nouvel arrivage, Pharmacie de garde)</li>
</ul>
<p>Pour les afficheurs, on souhaitera en plus changer les textes qui défilent, les images, etc.</p>
<p>Dans certains cas, quelques boutons-poussoirs ou un clavier sera placé sur l’enseigne ou l’afficheur. Souvent, on souhaite déporter le dispositif de commande. Dans ce cas, les données seront transférées par l’un des nombreux moyens qu’il existe pour communiquer avec un microcontrôleur : liaisons série asynchrone, I²C, etc.</p>
<p>Mais les enseignes et afficheurs, pour qu’ils soient bien visibles, sont souvent placés à des endroits peu accessibles, par exemple en hauteur. Les différentes techniques de commande sans fils sont alors les solutions les plus pratiques. Nous évoquerons quelques solutions basées sur des transmissions infrarouges et radio.</p>
<h2 id="infra-rouge">Infra-rouge</h2>
<p>Les LED infrarouges, associées à des phototransistors, offrent une manière très simple d’envoyer des informations à un afficheur. On connaît les télécommandes des téléviseurs et autres climatiseurs.</p>
<p>Une simple LED IR peut être utilisée comme émetteur. Mais pour que la liaison fonctionne sans être perturbée par toute sorte rayonnements infra-rouges, tels que les tubes fluorescents, les signaux d’une télécommande sont modulés à une fréquence bien précise. Il s’agit généralement de 38 kHz. La réception se fait alors avec de circuits qui contiennent non seulement un photo transistor, mais également un filtre très sélectif réglé sur cette fréquence de 38 kHz.</p>
<p>Voici un schéma pour une transmission par infrarouge :</p>
<div class="figure">
<img src="images/schema-ir.png" title="Transmission infrarouge" alt="Transmission infrarouge" width="566" />
<p class="caption">Transmission infrarouge</p>
</div>
<h2 id="radio">Radio</h2>
<p>Les signaux radios peuvent aussi être utilisés pour communiquer avec un afficheur. Bien entendu, il faut alors respecter la législation en vigueur dans chaque pays.</p>
<p>En Europe, une bande de fréquence autour de 433 MHz est libre. Une puissance maximale ne soit pas dépassée. On trouve de petites paires de modules émetteur-récepteur. Voici comment ils se présentent :</p>
<div class="figure">
<img src="images/modules-radio.jpg" title="Modules radio 433 MHz" alt="Modules radio 433 MHz" width="566" />
<p class="caption">Modules radio 433 MHz</p>
</div>
<p>La mise en œuvre semble très simple. L’émetteur et le récepteur doivent être alimentés. L’émetteur dispose d’une entrée qui active l’émission radio. Il dispose aussi d’une entrée de modulation. Le récepteur offre simplement une sortie, qui correspond au signal modulé. En principe, le signal sortant du récepteur doit être l’image du signal entrant dans l’émetteur.</p>
<p>Mais des contraintes bien particulières doivent être imposées au signal pour que la liaison fonctionne : le signal ne doit pas avoir de composante continue et les durées des 0 et des 1 successifs doivent être contenues dans un intervalle limité.</p>
<p>On utilisera donc souvent des librairies spécialisées pour mettre en œuvre de tels modules, comme la librairie <em>Virtual-Wire</em>.</p>
<h2 id="bluetooth">Bluetooth</h2>
<p>Le standard Bluetooth présente plusieurs avantages :</p>
<ul>
<li>C’est un standard disponible sur beaucoup de systèmes informatique : smartphones, tablettes et PC.</li>
<li>Il est économe en énergie, surtout en mode <em>Low energy</em>. Mais c’est avantage n’est pas déterminant pour une enseigne ou un afficheur, qui consomment eux-même beaucoup de courant.</li>
<li>La confidentialité des données est assurée par des mots de passe et le cryptage des données transmises.</li>
</ul>
<p>Mais si la couche d’établissement de la communication et de la transmission des données est standardisée, le contenu des données est libre. Il est donc nécessaire de faire fonctionner sur le terminal utilisé (Smartphone, tablette, PC) un logiciel dédié.</p>
<p>Le système d’exploitation <em>Android</em> permet d’écrire facilement des applications qui communiquent par Bluetooth. L'application doit alors être installée avant de pouvoir communiquer</p>
<h2 id="wifi">WiFi</h2>
<p>Le standard WiFi permet généralement de relier des ordinateurs en réseau. Sa complexité et ses performances peuvent sembler dépasser les besoins d’une enseigne ou d’un afficheur. Mais l’avantage du WiFi est qu’il va permettre la connexion à un système informatique sans devoir le configurer de manière spécifique, en utilisant des protocoles comme HTTP : il sera alors possible de dialoguer avec l’afficheur avec un simple navigateur Internet (<em>Web browser</em>).</p>
<p>Or des modules très peu coûteux sont apparus sur le marché il y a quelques années. Il est donc possible de rendre un afficheur paramétrable par WiFi avec un minimum d’effort et de coût.</p>
<h2 id="esp8266">ESP8266</h2>
<p>Le circuit ESP8266 du fabricant chinois Espressif Systems est un System-on-Chip (SoC) qui comporte tout ce qu’il faut pour le WiFi. On le trouve généralement sous forme de modules, tels que le EP-01 ou le EP-12.</p>
<div class="figure">
<img src="images/modules-esp8266.jpg" title="Modules EP-01 et EP-12" alt="Modules EP-01 et EP-12" width="566" />
<p class="caption">Modules EP-01 et EP-12</p>
</div>
<p>Ces modules contiennent le SoC ESP8266 ainsi qu’une mémoire EEPROM qui contient son programme. L’antenne est gravée directement sur le circuit imprimé. L’ESP8266 communique avec l’extérieur par une ligne série asynchrone. Il existe plusieurs manières de l'utiliser :</p>
<ul>
<li>Par un jeu de commandes commençant par les caractères &quot;AT&quot;, similaires à celles utilisées jadis avec les Modems.</li>
<li>En écrivant complètemenr le programme. Un environnement de développement est disponible pour cela : ESP-studio.</li>
<li>Dans le mode Arduino. Une librairie similaire à la librairie Arduino est alors utilisée, avec un environnement similaire au programme Arduino.</li>
<li>En mode <strong>NodeMCU</strong>. La programmation s’effectue par des scripts écrits dans le langage <strong>Lua</strong>. C’est un langage de haut niveau interprété, un peu similaire à Python, qui a l’avantage d’être peu gourmand en ressource.</li>
</ul>
<h2 id="openwrt">OpenWRT</h2>
<p>Une solution encore plus avancée est d'utiliser un environnement comportant assez de mémoire pour faire fonctionner une distribution Linux. La distribution OpenWRT est prévue pour les routeurs WiFi.</p>
</body>
</html>